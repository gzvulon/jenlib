# https://taskfile.dev
version: '3'

vars:
  DIMAGE: "squidfunk/mkdocs-material"
  DSERVE_PORT: 8690:8690
  DARGS: "-v ${PWD}:/docs"

tasks:
  _denv: &_ref__denv
    desc: _
    # vars:
    #   TASK_LAST: "{{.TASK | splitList | last}}"
    cmds:
      - mkdir -p __localbuild__/site && chmod 777 __localbuild__/site
      - docker run --rm {{ .DARGS }} {{.DMORE}} {{ .DIMAGE }} {{.DCMD}}

  build:
    <<: *_ref__denv
    vars:
      DCMD: build

  serve:
    <<: *_ref__denv
    vars:
      DCMD: serve
      DMORE: -p {{.DSERVE_PORT}}

  shell:
    <<: *_ref__denv
    vars:
      DMORE:
        |
        -p {{.DSERVE_PORT}} \
        -it --entrypoint /bin/sh
